"use strict";(self.webpackChunktruss_docs_2=self.webpackChunktruss_docs_2||[]).push([[932],{3979:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>u});var n=a(4848),t=a(8453),s=a(1470),i=a(9365);const l={sidebar_position:2},c="Using the API",o={id:"data/api",title:"Using the API",description:"Documentation on using the API",source:"@site/docs/data/api.md",sourceDirName:"data",slug:"/data/api",permalink:"/truss-docs/data/api",draft:!1,unlisted:!1,editUrl:"https://github.com/truss-security/truss-docs/blob/main/docs/data/api.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"dataSidebar",previous:{title:"Security Data",permalink:"/truss-docs/data/"},next:{title:"Plans and Pricing",permalink:"/truss-docs/data/plans"}},d={},u=[{value:"Search",id:"search",level:2},{value:"By Date",id:"by-date",level:3},{value:"By category and source",id:"by-category-and-source",level:3},{value:"Using Filters",id:"using-filters",level:3},{value:"By indicators",id:"by-indicators",level:3},{value:"Using limit",id:"using-limit",level:3},{value:"Paging",id:"paging",level:3},{value:"Examples",id:"examples",level:2}];function h(e){const r={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h1,{id:"using-the-api",children:"Using the API"}),"\n",(0,n.jsx)(r.p,{children:"Documentation on using the API"}),"\n",(0,n.jsx)(r.h2,{id:"search",children:"Search"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.code,{children:"/product/search"})}),"\n",(0,n.jsx)(r.p,{children:"The Truss search function is a powerful endpoint that is designed to accommodate most data access needs. This endpoint allows users to retrieve comprehensive slices of security data efficiently and effectively. There are two types of search parameters: primary and secondary. The primary search parameters are indexed in the database and are used to limit the number of records returned by the search. The secondary search parameters are used to filter the data returned from search before returning it."}),"\n",(0,n.jsx)(r.h3,{id:"by-date",children:"By Date"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"startdate:"})," Return products uploaded on or after this date."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"enddate:"})," Return products uploaded on or before this date."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"days:"})," Return products uploaded since N days ago."]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Searches may be time boxed using the ",(0,n.jsx)(r.code,{children:"startdate"})," and ",(0,n.jsx)(r.code,{children:"enddate"})," parameters using ",(0,n.jsx)(r.em,{children:"unix epoch time"})," in milliseconds. For example, the following example will return all security products entered since the specified start date (Sun Jun  2 19:55:10 MDT 2024)."]}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"curl",label:"curl",default:!0,children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:'curl -X \'POST\' \\\n  "https://api.truss-security.com/product/search" \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "startDate": 1717379710282\n  }\'\n'})})}),(0,n.jsx)(i.A,{value:"javascript",label:"javascript",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"{\n  startDate: 1717379710282\n}\n"})})})]}),"\n",(0,n.jsxs)(r.p,{children:["If a ",(0,n.jsx)(r.code,{children:"days"})," parameter is included the search returns security products entered since that number of days in the past to the current time. This parameter will be used in place of ",(0,n.jsx)(r.code,{children:"startdate"})," and ",(0,n.jsx)(r.code,{children:"enddate"})," parameters."]}),"\n",(0,n.jsx)(r.admonition,{type:"info",children:(0,n.jsxs)(r.p,{children:["When a ",(0,n.jsx)(r.code,{children:"days"})," parameter is entered, ",(0,n.jsx)(r.code,{children:"startdate"})," and ",(0,n.jsx)(r.code,{children:"enddate"})," parameters will be ignored."]})}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"curl",label:"curl",default:!0,children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:'curl -X \'POST\' \\\n  "https://api.truss-security.com/product/search" \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "days": 7\n  }\'\n'})})}),(0,n.jsx)(i.A,{value:"javascript",label:"javascript",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"{\n  days: 7\n}\n"})})})]}),"\n",(0,n.jsx)(r.h3,{id:"by-category-and-source",children:"By category and source"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"category:"})," Exact match for category name."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"source:"})," Exact match for source name."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"These primary parameters are indexed in the database, ensuring optimized and quick data retrieval."}),"\n",(0,n.jsx)(r.h3,{id:"using-filters",children:"Using Filters"}),"\n",(0,n.jsx)(r.p,{children:"There are also several secondary search parameters that can be used to further filter the search results. These include:"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.code,{children:"author | title | tags | validators | industry | region"})}),"\n",(0,n.jsxs)(r.p,{children:["If more than one secondary parameter is specified in a search, then the search will return those products that satisfy both of the specified parameters. In other words, the search performs an ",(0,n.jsx)(r.code,{children:"AND"})," between the different parameters."]}),"\n",(0,n.jsxs)(r.p,{children:["Secondary search parameters that are of type ",(0,n.jsx)(r.code,{children:"string"})," (e.g., title) only allow you to pass in a single string. The search will return any security products where that parameter CONTAINS that string."]}),"\n",(0,n.jsxs)(r.p,{children:["Secondary search parameters that are of type ",(0,n.jsx)(r.code,{children:"array of strings"})," (e.g., author, tags, validators, industry, region, indicators) allow you to pass in an array of strings. The search will return any security products where ANY of the strings are found. In other words, the search performs an ",(0,n.jsx)(r.code,{children:"OR"})," between the strings passed as an array to a single parameter."]}),"\n",(0,n.jsx)(r.p,{children:"Consider the following search:"}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"curl",label:"curl",default:!0,children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:'curl -X \'POST\' \\\n  "https://api.truss-security.com/product/search" \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "author": ["TOR Project"],\n    "tags": ["C2", "AlphV"]\n  }\'\n'})})}),(0,n.jsx)(i.A,{value:"javascript",label:"javascript",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:'{\n  author: ["Researcher 1"],\n  tags: ["C2", "AlphV"],\n}\n'})})})]}),"\n",(0,n.jsxs)(r.p,{children:["This will return all security products where the ",(0,n.jsx)(r.code,{children:"author"}),' is "Researcher 1" ',(0,n.jsx)(r.code,{children:"AND"})," where the ",(0,n.jsx)(r.code,{children:"tags"}),' are "C2" OR "AlphV".']}),"\n",(0,n.jsx)(r.h3,{id:"by-indicators",children:"By indicators"}),"\n",(0,n.jsx)(r.p,{children:"Indicators in a product have a format like the following:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:'indicators: {\n    IPV4: ["94.103.91.246"],\n    URL: [\n      "http://94.103.91.246/incrementLaunch",\n      "http://94.103.91.246/upload",\n      "http://94.103.91.246/addInfection"\n    ],\n    FILENAME: ["*.ghost"]\n  }\n'})}),"\n",(0,n.jsxs)(r.p,{children:["It is possible to search for one or more indicators. For example, the following search will return all security products that have been entered since the specified start date, with the ",(0,n.jsx)(r.code,{children:"category"}),' of "Ransomeware" and ',(0,n.jsx)(r.code,{children:"IP"}),' indicators "45.61.138.109" OR "185.141.62.123" OR the ',(0,n.jsx)(r.code,{children:"SHA1"}),' indicator "bbfc22ac7985902fdf0dd91c5bf270967cf1f474".']}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"curl",label:"curl",default:!0,children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:'curl -X \'POST\' \\\n  "https://api.truss-security.com/product/search" \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "category": "Ransomware"\n    "startDate": 1717379710282,\n    "indicators": {\n      "IP": ["45.61.138.109", "185.141.62.123"],\n      "SHA1": ["bbfc22ac7985902fdf0dd91c5bf270967cf1f474"]\n    }\n  }\'\n'})})}),(0,n.jsx)(i.A,{value:"javascript",label:"javascript",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:'{\n  category: "Ransomware",\n  startDate: 1717379710282,\n  indicators: {\n    IP: ["45.61.138.109", "185.141.62.123"],\n    SHA1: ["bbfc22ac7985902fdf0dd91c5bf270967cf1f474"]\n  }\n}\n'})})})]}),"\n",(0,n.jsx)(r.h3,{id:"using-limit",children:"Using limit"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"limit:"})," The maximum number of records to return."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"paging",children:"Paging"}),"\n",(0,n.jsxs)(r.p,{children:["Searches where Primary Search Parameters are not specified or which return a large number of products may only return a subset of the total number of products that would be satified by the search. In these cases the search will return metadata in the form of a ",(0,n.jsx)(r.code,{children:"LastEvaluatedKey"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["The format of ",(0,n.jsx)(r.code,{children:"LastEvaluatedKey"}),":"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"LastEvaluatedKey: {\n  GSI1PK: 'PROD',\n  SK: 'VER#0',\n  GSI1SK: 1717377712019,\n  PK: 'PROD#01HKDT164VYRS50ZQ8RJEHHBH0'\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["To get the next page of the data you pass this object in as a ",(0,n.jsx)(r.code,{children:"LastEvaluatedKey"})," parameter for the next search."]}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"curl",label:"curl",default:!0,children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:'curl -X \'POST\' \\\n  "https://api.truss-security.com/product/search" \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "category": "Ransomware"\n    "LastEvaluatedKey": {\n      "GSI1PK": "PROD",\n      SK: "VER#0",\n      GSI1SK: 1717377712019,\n      PK: "PROD#01HKDT164VYRS50ZQ8RJEHHBH0"\n    }\n  }\'\n'})})}),(0,n.jsx)(i.A,{value:"javascript",label:"javascript",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"{\n  category: \"Ransomware\",\n  LastEvaluatedKey: {\n    GSI1PK: 'PROD',\n    SK: 'VER#0',\n    GSI1SK: 1717377712019,\n    PK: 'PROD#01HKDT164VYRS50ZQ8RJEHHBH0'\n  }\n}\n"})})})]}),"\n",(0,n.jsx)(r.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsx)(r.p,{children:'Often, you will want to combine primary search parameters with secondary filters. For example, the following example will return all security products entered since the specified start date with the indicators "94.103.91.246" OR "*.ghost"'}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"curl",label:"curl",default:!0,children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:'curl -X \'POST\' \\\n  "https://api.truss-security.com/product/search" \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "startDate": 1717379710282,\n    "tags": ["C2"]\n  }\'\n'})})}),(0,n.jsx)(i.A,{value:"javascript",label:"javascript",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:'{\n  startDate: 1717379710282,\n  tags: ["C2"]\n}\n'})})})]})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},9365:(e,r,a)=>{a.d(r,{A:()=>i});a(6540);var n=a(4164);const t={tabItem:"tabItem_Ymn6"};var s=a(4848);function i(e){let{children:r,hidden:a,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(t.tabItem,i),hidden:a,children:r})}},1470:(e,r,a)=>{a.d(r,{A:()=>w});var n=a(6540),t=a(4164),s=a(3104),i=a(6347),l=a(205),c=a(7485),o=a(1682),d=a(9466);function u(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:r,children:a}=e;return(0,n.useMemo)((()=>{const e=r??function(e){return u(e).map((e=>{let{props:{value:r,label:a,attributes:n,default:t}}=e;return{value:r,label:a,attributes:n,default:t}}))}(a);return function(e){const r=(0,o.X)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,a])}function p(e){let{value:r,tabValues:a}=e;return a.some((e=>e.value===r))}function m(e){let{queryString:r=!1,groupId:a}=e;const t=(0,i.W6)(),s=function(e){let{queryString:r=!1,groupId:a}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:r,groupId:a});return[(0,c.aZ)(s),(0,n.useCallback)((e=>{if(!s)return;const r=new URLSearchParams(t.location.search);r.set(s,e),t.replace({...t.location,search:r.toString()})}),[s,t])]}function x(e){const{defaultValue:r,queryString:a=!1,groupId:t}=e,s=h(e),[i,c]=(0,n.useState)((()=>function(e){let{defaultValue:r,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!p({value:r,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:r,tabValues:s}))),[o,u]=m({queryString:a,groupId:t}),[x,f]=function(e){let{groupId:r}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(r),[t,s]=(0,d.Dv)(a);return[t,(0,n.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:t}),j=(()=>{const e=o??x;return p({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{j&&c(j)}),[j]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),f(e)}),[u,f,s]),tabValues:s}}var f=a(2303);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=a(4848);function y(e){let{className:r,block:a,selectedValue:n,selectValue:i,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:o}=(0,s.a_)(),d=e=>{const r=e.currentTarget,a=c.indexOf(r),t=l[a].value;t!==n&&(o(r),i(t))},u=e=>{let r=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;r=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;r=c[a]??c[c.length-1];break}}r?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":a},r),children:l.map((e=>{let{value:r,label:a,attributes:s}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:n===r?0:-1,"aria-selected":n===r,ref:e=>c.push(e),onKeyDown:u,onClick:d,...s,className:(0,t.A)("tabs__item",j.tabItem,s?.className,{"tabs__item--active":n===r}),children:a??r},r)}))})}function b(e){let{lazy:r,children:a,selectedValue:t}=e;const s=(Array.isArray(a)?a:[a]).filter(Boolean);if(r){const e=s.find((e=>e.props.value===t));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:s.map(((e,r)=>(0,n.cloneElement)(e,{key:r,hidden:e.props.value!==t})))})}function v(e){const r=x(e);return(0,g.jsxs)("div",{className:(0,t.A)("tabs-container",j.tabList),children:[(0,g.jsx)(y,{...r,...e}),(0,g.jsx)(b,{...r,...e})]})}function w(e){const r=(0,f.A)();return(0,g.jsx)(v,{...e,children:u(e.children)},String(r))}},8453:(e,r,a)=>{a.d(r,{R:()=>i,x:()=>l});var n=a(6540);const t={},s=n.createContext(t);function i(e){const r=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);